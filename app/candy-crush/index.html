<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Candy Crush</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        .container {
            text-align: center;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: #333;
        }

        #game-board {
            display: grid;
            grid-template-columns: repeat(8, 50px);
            grid-template-rows: repeat(8, 50px);
            gap: 5px;
            background-color: #fff;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .cell {
            width: 50px;
            height: 50px;
            background-color: #ddd;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5em;
            cursor: pointer;
            user-select: none;
            transition: transform 0.2s ease, background-color 0.2s ease;
        }

        .cell.matched {
            animation: pop 0.5s ease;
        }

        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        #score {
            margin-top: 20px;
            font-size: 1.5em;
            color: #333;
        }

        #gacor-effect {
            margin-top: 20px;
            font-size: 2em;
            color: #ffcc00;
            display: none;
            animation: gacor 1s ease;
        }

        @keyframes gacor {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Candy Crush</h1>
        <div id="game-board"></div>
        <div id="score">Score: 0</div>
        <div id="gacor-effect">GACOR! üéâ</div>
    </div>

    <!-- Audio untuk efek suara -->
    <audio id="match-sound" src="https://www.soundjay.com/button/beep-07.mp3"></audio>
    <audio id="gacor-sound" src="https://www.soundjay.com/misc/success-bell-01.mp3"></audio>

    <script>
        const board = document.getElementById('game-board');
        const scoreDisplay = document.getElementById('score');
        const gacorEffect = document.getElementById('gacor-effect');
        const matchSound = document.getElementById('match-sound');
        const gacorSound = document.getElementById('gacor-sound');
        const width = 8;
        let score = 0;
        let boardCells = [];
        let selectedCell = null;
        let isDragging = false;

        const candies = ['üç≠', 'üç¨', 'üç´', 'üç©', 'üç™'];

        // Create the game board
        function createBoard() {
            for (let i = 0; i < width * width; i++) {
                const cell = document.createElement('div');
                cell.classList.add('cell');
                cell.dataset.index = i;
                cell.textContent = candies[Math.floor(Math.random() * candies.length)];
                cell.addEventListener('mousedown', handleMouseDown);
                cell.addEventListener('mouseup', handleMouseUp);
                cell.addEventListener('touchstart', handleTouchStart);
                cell.addEventListener('touchend', handleTouchEnd);
                board.appendChild(cell);
                boardCells.push(cell);
            }
        }

        // Handle mouse down (for desktop)
        function handleMouseDown(e) {
            isDragging = true;
            selectedCell = e.target;
            selectedCell.style.backgroundColor = '#ffcc00';
        }

        // Handle mouse up (for desktop)
        function handleMouseUp(e) {
            if (!isDragging) return;
            isDragging = false;

            const targetCell = e.target;
            if (selectedCell && targetCell && selectedCell !== targetCell) {
                const selectedIndex = parseInt(selectedCell.dataset.index);
                const targetIndex = parseInt(targetCell.dataset.index);

                if (isAdjacent(selectedIndex, targetIndex)) {
                    swapCells(selectedCell, targetCell);
                    if (!checkMatches()) {
                        // If no matches, swap back
                        setTimeout(() => {
                            swapCells(selectedCell, targetCell);
                        }, 500);
                    }
                }
            }

            if (selectedCell) {
                selectedCell.style.backgroundColor = '#ddd';
                selectedCell = null;
            }
        }

        // Handle touch start (for mobile)
        function handleTouchStart(e) {
            isDragging = true;
            selectedCell = e.target;
            selectedCell.style.backgroundColor = '#ffcc00';
        }

        // Handle touch end (for mobile)
        function handleTouchEnd(e) {
            if (!isDragging) return;
            isDragging = false;

            const touch = e.changedTouches[0];
            const targetCell = document.elementFromPoint(touch.clientX, touch.clientY);

            if (selectedCell && targetCell && selectedCell !== targetCell) {
                const selectedIndex = parseInt(selectedCell.dataset.index);
                const targetIndex = parseInt(targetCell.dataset.index);

                if (isAdjacent(selectedIndex, targetIndex)) {
                    swapCells(selectedCell, targetCell);
                    if (!checkMatches()) {
                        // If no matches, swap back
                        setTimeout(() => {
                            swapCells(selectedCell, targetCell);
                        }, 500);
                    }
                }
            }

            if (selectedCell) {
                selectedCell.style.backgroundColor = '#ddd';
                selectedCell = null;
            }
        }

        // Check if two cells are adjacent
        function isAdjacent(index1, index2) {
            const row1 = Math.floor(index1 / width);
            const col1 = index1 % width;
            const row2 = Math.floor(index2 / width);
            const col2 = index2 % width;

            return Math.abs(row1 - row2) + Math.abs(col1 - col2) === 1;
        }

        // Swap two cells
        function swapCells(cell1, cell2) {
            const temp = cell1.textContent;
            cell1.textContent = cell2.textContent;
            cell2.textContent = temp;
        }

        // Check for matches
        function checkMatches() {
            let matchesFound = false;

            // Check rows
            for (let i = 0; i < width * width; i += width) {
                for (let j = 0; j < width - 2; j++) {
                    const index1 = i + j;
                    const index2 = index1 + 1;
                    const index3 = index2 + 1;

                    if (
                        boardCells[index1].textContent &&
                        boardCells[index1].textContent === boardCells[index2].textContent &&
                        boardCells[index2].textContent === boardCells[index3].textContent
                    ) {
                        matchesFound = true;
                        clearMatches([index1, index2, index3]);
                    }
                }
            }

            // Check columns
            for (let i = 0; i < width; i++) {
                for (let j = 0; j < width - 2; j++) {
                    const index1 = i + j * width;
                    const index2 = index1 + width;
                    const index3 = index2 + width;

                    if (
                        boardCells[index1].textContent &&
                        boardCells[index1].textContent === boardCells[index2].textContent &&
                        boardCells[index2].textContent === boardCells[index3].textContent
                    ) {
                        matchesFound = true;
                        clearMatches([index1, index2, index3]);
                    }
                }
            }

            if (matchesFound) {
                updateScore();
                showGacorEffect();
                refillBoard();
            }

            return matchesFound;
        }

        // Clear matched cells
        function clearMatches(matches) {
            matches.forEach(index => {
                boardCells[index].classList.add('matched');
                matchSound.play(); // Play match sound
            });
            setTimeout(() => {
                matches.forEach(index => {
                    boardCells[index].textContent = '';
                    boardCells[index].classList.remove('matched');
                });
            }, 500);
        }

        // Update score
        function updateScore() {
            score += 10;
            scoreDisplay.textContent = `Score: ${score}`;
        }

        // Show "GACOR!" effect
        function showGacorEffect() {
            gacorEffect.style.display = 'block';
            gacorSound.play(); // Play gacor sound
            setTimeout(() => {
                gacorEffect.style.display = 'none';
            }, 1000);
        }

        // Refill the board
        function refillBoard() {
            for (let i = 0; i < width * width; i++) {
                if (boardCells[i].textContent === '') {
                    boardCells[i].textContent = candies[Math.floor(Math.random() * candies.length)];
                }
            }
            checkMatches(); // Check for new matches after refilling
        }

        // Start the game
        createBoard();
    </script>
</body>
</html>
